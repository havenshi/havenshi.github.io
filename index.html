<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Welcome to Haven's blog!</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Welcome to Haven's blog! </a></h1>
                <nav><ul>
                    <li><a href="/category/about.html">About</a></li>
                    <li><a href="/category/drawing.html">Drawing</a></li>
                    <li><a href="/category/english.html">English</a></li>
                    <li><a href="/category/python.html">Python</a></li>
                    <li><a href="/category/technology.html">Technology</a></li>
                    <li><a href="/category/travel.html">Travel</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/publish-avro-message-to-kafka-topic.html">Publish Avro message to Kafka topic</a></h1>
<footer class="post-info">
        <abbr class="published" title="2019-02-23T10:50:00">
                Sat 23 February 2019
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/technology.html">Technology</a>. </p>
<p>tags: <a href="/tag/kafka.html">Kafka</a><a href="/tag/avro.html">Avro</a><a href="/tag/spark.html">Spark</a><a href="/tag/hive.html">Hive</a></p>
</footer><!-- /.post-info --><p>This article combines high level architectural design and hands-on scripting experience from Kafka POC project.</p>
<h3>Driver</h3>
<p>The first step is to create Driver. In the driver we use SparkConf to set parameter, then Spark cluster can allocate resources on cluster. We also need SparkContext, when the parameter is passed to SparkContext, it will ask Spark cluster manager to allocate resource for executers. Resource manager set master node and worker nodes (like Master-Slave model) to allocate executors, for example, when we use spark streaming to publish or consume data, RDDs will be sent to different worker nodes. </p>
<div class="highlight"><pre><span class="n">val</span> <span class="n">conf</span> <span class="o">=</span> <span class="n">new</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="s">&quot;SparkDriverName&quot;</span><span class="p">)</span>

<span class="n">val</span> <span class="n">sc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">SparkContext</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>

<span class="n">val</span> <span class="n">sqlc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HiveContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</pre></div>


<h3>DAO</h3>
<p>The second step is to create DAO. In Sparks model we use HiveContext to implement SQL query, if the data comes from local, we read from local path and use HiveContext to register temp table with DBName.TableName, or we connect to hive table.</p>
<div class="highlight"><pre><span class="n">Local</span> <span class="n">csv</span><span class="p">:</span> <span class="n">sqlc</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="err">”</span><span class="n">com</span><span class="o">.</span><span class="n">databricks</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">csv</span><span class="err">”</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="err">“</span><span class="n">header</span><span class="err">”</span><span class="p">,</span><span class="err">”</span><span class="n">true</span><span class="err">”</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">LocalCSVPath</span><span class="p">)</span><span class="o">.</span><span class="n">registerTempTable</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

<span class="ow">or</span>

<span class="n">Hive</span> <span class="n">table</span><span class="p">:</span> <span class="n">Sqlc</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">DBName</span> <span class="o">+</span><span class="err">”</span><span class="o">.</span><span class="err">”</span><span class="o">+</span> <span class="n">TableName</span><span class="p">)</span><span class="o">.</span><span class="n">registerTempTable</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

<span class="n">Then</span><span class="p">,</span>

<span class="n">sqlc</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
</pre></div>


<p>Hive has metastore service which stores metadata including relationship and partition for relational database in master node, and the data is stored in HDFS server. Mostly we create internal table, security is controlled by Hive since delete the table will cause both metadata and data lost. Compared with external table, delete internal table only causes metadata deleted.</p>
<h3>Dataframe</h3>
<p>With Data access object with can use Spark SQL to create dataframe, the business logic will be implemented in this step. We use expr to input SQL query as a string variable and transform input dataframe to output dataframe. For this part research and test is necessary, since Spark SQL is not exactly the same as Oracle SQL.</p>
<div class="highlight"><pre><span class="n">val</span> <span class="n">SQLExpression</span> <span class="o">=</span> <span class="err">”</span><span class="n">SQLQuery</span><span class="err">”</span>

<span class="n">InputDataframe</span><span class="o">.</span><span class="k">as</span><span class="p">(</span><span class="err">“</span><span class="n">DfName</span><span class="err">”</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">InputDataframe2</span><span class="p">,</span> <span class="n">Seq</span><span class="p">(</span><span class="err">“</span><span class="n">ColumnName</span><span class="err">”</span><span class="p">),</span> <span class="err">“</span><span class="n">left_outer</span><span class="err">”</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="err">“</span><span class="n">ColumnName</span><span class="err">”</span><span class="p">,</span> <span class="n">SQLExpression</span><span class="p">))</span>

<span class="n">val</span> <span class="n">sqlc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HiveContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</pre></div>


<h3>Java Object</h3>
<p>Avro has Json like data model and it can present complex data structure with business logic. With advantages as direct mapping to JSON and great binding for wide variety of programming languages, we can download an open source avro tools to generate Java object automatically from Avro schema. Then we use Jackson mapper to convert generic class to this format.</p>
<div class="highlight"><pre><span class="n">java</span> <span class="o">-</span><span class="n">jar</span> <span class="n">avro</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="mf">1.8</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">cdhxxx</span><span class="o">.</span><span class="n">jar</span> <span class="nb">compile</span> <span class="n">schema</span> <span class="n">AvroSchemaName</span><span class="o">.</span><span class="n">avsc</span> <span class="n">FolderName</span>

<span class="n">val</span> <span class="n">JavaObj</span><span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">readValue</span><span class="p">(</span><span class="n">JavaObject</span><span class="p">,</span> <span class="n">classof</span><span class="p">[</span><span class="n">JavaClassName</span><span class="p">])</span>
</pre></div>


<h3>Serialize</h3>
<p>After we register Avro schema on Confluent platform, we use data serialization system of Avro to convert Java object to a compact binary format which is faster and easier to publish. Please review the next step.</p>
<h3>Publish</h3>
<p>The last step is publish. Spark streaming can accumulate the messages for a short period of time as RDStream rather than process the messages one by one, and then publish. Inside each DStream there are RDDs, and each RDD is composed with partitions. Messages is are divided into partitions, offset is assigned to partitions and it will be used to maintain the order and tell the publisher where to start.</p>
<p>Since RDDs are scaled to multiple worker nodes, only if we use collect can do count/first/top or other action functions, otherwise we can only do transformation functions like filter/groupby.</p>
<div class="highlight"><pre><span class="n">Dataframe</span><span class="o">.</span><span class="n">foreachPartition</span><span class="p">(</span><span class="n">records</span><span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">records</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">record</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">Val</span> <span class="n">SerializedData</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ProducerRecord</span><span class="p">[</span><span class="n">String</span><span class="p">,</span> <span class="n">JavaClassName</span><span class="p">](</span><span class="n">TopicName</span><span class="p">,</span> <span class="n">JavaObj</span><span class="p">)</span>
    <span class="n">Producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">SerializedData</span><span class="p">)</span><span class="o">.</span><span class="n">get</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p><img alt="Kafka design" src="https://raw.githubusercontent.com/havenshi/havenshi.github.io/master/images/Publish%20Avro%20message%20to%20Kafka%20topic.jpg" /></p>
<h5>Reference</h5>
<ul>
<li><a href="https://spark.apache.org/docs/1.6.1/sql-programming-guide.html">https://spark.apache.org/docs/1.6.1/sql-programming-guide.html</a></li>
<li><a href="https://blogs.msdn.microsoft.com/bigdatasupport/2015/09/14/understanding-sparks-sparkconf-sparkcontext-sqlcontext-and-hivecontext/">https://blogs.msdn.microsoft.com/bigdatasupport/2015/09/14/understanding-sparks-sparkconf-sparkcontext-sqlcontext-and-hivecontext/</a></li>
<li><a href="https://www.cloudera.com/documentation/enterprise/5-8-x/topics/cdh_ig_hive_metastore_configure.html">https://www.cloudera.com/documentation/enterprise/5-8-x/topics/cdh_ig_hive_metastore_configure.html</a></li>
<li><a href="https://data-flair.training/blogs/hive-internal-tables-vs-external-tables/">https://data-flair.training/blogs/hive-internal-tables-vs-external-tables/</a></li>
<li><a href="https://stackoverflow.com/questions/34885013/difference-between-hive-internal-hive-table-and-external-hive-table/50738216#50738216">https://stackoverflow.com/questions/34885013/difference-between-hive-internal-hive-table-and-external-hive-table/50738216#50738216</a></li>
<li><a href="https://stackoverflow.com/questions/32621990/what-are-workers-executors-cores-in-spark-standalone-cluster">https://stackoverflow.com/questions/32621990/what-are-workers-executors-cores-in-spark-standalone-cluster</a></li>
<li><a href="https://andr83.io/en/1090/">https://andr83.io/en/1090/</a></li>
<li><a href="https://www.slideshare.net/qubolemarketing/big-data-platform-at-pinterest/12-Centralized_Hive_MetastoreHiveMetastorePigCascadingHiveHDFSS3DataMetadata">https://www.slideshare.net/qubolemarketing/big-data-platform-at-pinterest/12-Centralized_Hive_MetastoreHiveMetastorePigCascadingHiveHDFSS3DataMetadata</a></li>
<li><a href="https://www.confluent.io/blog/avro-kafka-data/">https://www.confluent.io/blog/avro-kafka-data/</a></li>
<li><a href="http://aseigneurin.github.io/2016/03/04/kafka-spark-avro-producing-and-consuming-avro-messages.html">http://aseigneurin.github.io/2016/03/04/kafka-spark-avro-producing-and-consuming-avro-messages.html</a></li>
</ul>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/kafka-note.html" rel="bookmark"
                           title="Permalink to Kafka note">Kafka note</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-10T20:40:00">
                Mon 10 September 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/technology.html">Technology</a>. </p>
<p>tags: <a href="/tag/kafka.html">Kafka</a><a href="/tag/zookeeper.html">Zookeeper</a></p>
</footer><!-- /.post-info -->                <p>Changing from user to superuser: <strong>sudo su</strong></p>
<div class="highlight"><pre><span class="nb">bin</span><span class="o">/</span><span class="n">zookeeper</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">start</span><span class="o">.</span><span class="n">sh</span> <span class="n">config</span><span class="o">/</span><span class="n">zookeeper</span><span class="o">.</span><span class="n">properties</span>
<span class="nb">bin</span><span class="o">/</span><span class="n">kafka</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">start</span><span class="o">.</span><span class="n">sh</span> <span class="n">config</span><span class="o">/</span><span class="n">server</span><span class="o">.</span><span class="n">properties</span>
</pre></div>


<p>should be run in <strong>two terminals</strong></p>
<p>found port 2181 used, kill the program run on port 2181</p>
<div class="highlight"><pre><span class="n">env</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">JAVA</span>
<span class="n">JAVA_HOME</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">jdk</span><span class="o">/</span><span class="n">jdk1</span><span class="o">.</span><span class="mf">8.0</span><span class="n">_181 ...</span></pre></div>
                <a class="readmore" href="/kafka-note.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/personification-of-programming-languages.html" rel="bookmark"
                           title="Permalink to Personification of Programming Languages">Personification of Programming Languages</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-07-05T13:25:00">
                Thu 05 July 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/drawing.html">Drawing</a>. </p>
<p>tags: <a href="/tag/python.html">python</a><a href="/tag/java.html">java</a><a href="/tag/c.html">c++</a><a href="/tag/personification.html">personification</a><a href="/tag/drawing.html">drawing</a></p>
</footer><!-- /.post-info -->                <h1>编程语言拟人图</h1>
<p>In the past few years, I have drawn a series of the personified bank departments. I tried to draw the <strong>programming language personification</strong> these days. There are three languages ​​that I have learned so far. The characteristics of those programming languages ​​are marked according to my personal understanding, and ...</p>
                <a class="readmore" href="/personification-of-programming-languages.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/shadow-of-the-colossus-is-an-awesome-game.html" rel="bookmark"
                           title="Permalink to Shadow of the Colossus is an awesome game!">Shadow of the Colossus is an awesome game!</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-05-31T00:00:00">
                Thu 31 May 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/drawing.html">Drawing</a>. </p>
<p>tags: <a href="/tag/drawing.html">drawing</a><a href="/tag/game.html">game</a></p>
</footer><!-- /.post-info -->                <h1>highly recommend you to play that game, Shadow of the Colossus.</h1>
<ul>
<li>I completed the mission to defeat 16 colossus. So moved at the story although the hero seldom talk. His lover woke up in the middle of the game, but then Wanda realized it was his imagination. It reminds me ...</li></ul>
                <a class="readmore" href="/shadow-of-the-colossus-is-an-awesome-game.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/za-zhi-she-ping-dan-yu-ji.html" rel="bookmark"
                           title="Permalink to 杂志社平淡遇记">杂志社平淡遇记</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-05T13:54:00">
                Mon 05 March 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/drawing.html">Drawing</a>. </p>
<p>tags: <a href="/tag/blog.html">blog</a></p>
</footer><!-- /.post-info -->                <h1>作者：Heather Shi</h1>
<p><strong> 这篇文章是imouto写的，言辞很生动调理很清晰，贴出来赏玩lol。</strong> </p>
<p>07年的某一天，还在菜着脸读大学的我，接到漫友杂志社发来的一封邀请短信，大意是邀请作为读者代表去北京编辑部交流什么的，不是人气作者签售，也不是幸运读者参观大楼，反正意思稀松平淡简明扼要，一定不是诈骗的那种信息陈述。当时国内的动漫文化产业环境比现在还差一些，漫友是积累了一定人气的很出色的主流杂志，每期模式是刊登3-4篇日漫漫评，推2-3部国漫连载，其它还有小说杂谈什么的。沉迷于动画茫然于未来的我，平日里来酷爱宅学校，当时突发奇想觉得应该透透气了，就顶着一棵包菜头晃过去了。嘛果然写文有一种审视自己人生轨迹的奇妙感觉呢，跟画画那种只是希望得到称赞的浮夸心境全然不同...扯远了。</p>
<p>杂志社办公楼离学校不算近，辗转了几次交通工具还是蛮早地到了。办公区也很普通的一层楼，没有哔哩哔哩那样哥特萝莉坐前台，意外很低调的感觉呢！（都跟你说了我们是文化产业。）模模糊糊记得是有个女生出来招呼的，引到里屋小圆桌前就转身忙去了。小圆桌上面摆放了几盘没有仔细看清的糖果，太拘束了也没敢拿来吃（心塞）。反正本来就没期望什么呀！顺着往上看，看到一个中学生同样困惑但无所谓地坐在对面。坐下之后我们面面相觑，过一会儿，一个男士就出来了，坐定跟我们聊了起来。</p>
<p>他是漫友的编辑，姓秦，后来跳到天闻角川去了。看上去很有风度，好像有点胖？说话很是斯文 ...</p>
                <a class="readmore" href="/za-zhi-she-ping-dan-yu-ji.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/mai-huo-chai-de-xiao-nu-hai-suan-fa-ti.html" rel="bookmark"
                           title="Permalink to 卖火柴的小女孩算法题">卖火柴的小女孩算法题</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-05T13:50:00">
                Mon 05 March 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/python.html">Python</a>. </p>
<p>tags: <a href="/tag/python.html">python</a><a href="/tag/code.html">code</a></p>
</footer><!-- /.post-info -->                <p>碰见这题的时候是一年前了。忙碌的一年下来再次回头撸一下，发现emmmm。。。竟然可以用dp做出来，有点欣慰额~~~</p>
<div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">makesquare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :type nums: List[int]</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">:</span> <span class="k">return</span> <span class="bp">False</span>
        <span class="n">target</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="bp">True</span> <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="n">target</span> <span class="k">else</span> <span class="bp">False</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">])</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>  <span class="c"># 检查是否有火柴大于边长</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c"># 不能用dp = [0 ...</span></pre></div>
                <a class="readmore" href="/mai-huo-chai-de-xiao-nu-hai-suan-fa-ti.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/do-to-list.html" rel="bookmark"
                           title="Permalink to Do to list">Do to list</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-01-28T11:06:00">
                Sun 28 January 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/technology.html">Technology</a>. </p>
<p>tags: <a href="/tag/machine-learning.html">machine learning</a><a href="/tag/java.html">java</a><a href="/tag/c.html">c++</a></p>
</footer><!-- /.post-info -->                <p>Java</p>
<p>machine learning</p>
<p>hadoop</p>
<p>C/C++</p>
<p>algorithm(stack,queue,kmp)</p>
                <a class="readmore" href="/do-to-list.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/dui-chu-feng-de-xie-gan-xiang.html" rel="bookmark"
                           title="Permalink to 对雏蜂的一些感想">对雏蜂的一些感想</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-01-07T00:15:00">
                Sun 07 January 2018
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/drawing.html">Drawing</a>. </p>
<p>tags: <a href="/tag/drawing.html">drawing</a><a href="/tag/manga.html">manga</a></p>
</footer><!-- /.post-info -->                <p>几年前我还画过雏蜂同人图，并且有幸被作者放在雏蜂漫画第六十几话的首页。加上大学年代参加过的一位现在画巨人作者的小型讲座，感觉这是自己最接近国漫业界大师的两次经历。</p>
<p>查了下资料发现雏蜂去年已停止了制作，唏嘘不已。在投资方、制作商和自媒体蜂拥而至的今天，这部作品的出现让我一度非常看好国漫的发展，然而由于运营模式和专业团队存在的问题，雏蜂还是辜负了当初奔走相告的粉丝的期待。希望未来这些优秀的作品会得到更多的尝试。</p>
<p><img alt="bee" src="https://raw.githubusercontent.com/havenshi/havenshi.github.io/master/images/bee.jpg" /></p>
                <a class="readmore" href="/dui-chu-feng-de-xie-gan-xiang.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/200-number-of-islands.html" rel="bookmark"
                           title="Permalink to 200. Number of Islands">200. Number of Islands</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-05-17T20:01:00">
                Wed 17 May 2017
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/python.html">Python</a>. </p>
<p>tags: <a href="/tag/python.html">python</a><a href="/tag/code.html">code</a></p>
</footer><!-- /.post-info -->                <div class="highlight"><pre><span class="k">class</span> <span class="nc">Solution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">numIslands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :type grid: List[List[str]]</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newgrid</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">]</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">newgrid</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ans</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">newgrid</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">newgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">newgrid</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j ...</span></pre></div>
                <a class="readmore" href="/200-number-of-islands.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/199-binary-tree-right-side-view.html" rel="bookmark"
                           title="Permalink to 199. Binary Tree Right Side View">199. Binary Tree Right Side View</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-05-17T20:00:00">
                Wed 17 May 2017
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/haven.html">Haven</a>
        </address>
<p>In <a href="/category/python.html">Python</a>. </p>
<p>tags: <a href="/tag/python.html">python</a><a href="/tag/code.html">code</a></p>
</footer><!-- /.post-info -->                <div class="highlight"><pre><span class="c"># Definition for a binary tree node.</span>
<span class="c"># class TreeNode(object):</span>
<span class="c">#     def __init__(self, x):</span>
<span class="c">#         self.val = x</span>
<span class="c">#         self.left = None</span>
<span class="c">#         self.right = None</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">rightSideView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :type root: TreeNode</span>
<span class="sd">        :rtype: List[int]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="n">root</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">queue ...</span></pre></div>
                <a class="readmore" href="/199-binary-tree-right-side-view.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
            </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 23
        <a href="/index2.html">&raquo;</a>
</p>
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>